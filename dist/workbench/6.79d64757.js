(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{618:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=_(r(623)),n=_(r(85)),o=_(r(6)),i=_(r(15)),u=_(r(4)),d=_(r(7)),l=_(r(635));r(259),r(642);var p=r(1),c=_(p),s=(_(r(0)),_(r(622))),f=_(r(258));r(921);var h=_(r(662)),g=r(629),m=r(646),v=r(655),y=r(857),k=_(r(856)),C=_(r(835)),b=_(r(834)),w=r(93),I=r(624),D=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(638)),G=r(185);function _(e){return e&&e.__esModule?e:{default:e}}var E=l.default.Header,x=l.default.Content,S=function(e){function t(e){(0,o.default)(this,t);var r=(0,u.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return r.state={workbenchid:"",relateid:""},r}return(0,d.default)(t,e),(0,i.default)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t=(0,G.GetQuery)(this.props.location.search),r=void 0;t.zhize&&(r=t.zhize),(0,f.default)({url:"/nccloud/platform/appregister/queryapp.do",data:{relateid:r},success:function(t){if(t){var a=t.data,n=a.data,o=a.success;o&&n&&n.length>0&&(s.default.forEach(n[0].groups,function(e){e.type="group",s.default.forEach(e.apps,function(e){e.isShadow=!1})}),e.props.updateGroupList(n[0].groups),e.setState({workbenchid:n[0].pk_workbench,relateid:r}))}}})}},{key:"calGridXY",value:function(e,t,r){var a=this.props.layout,n=a.margin,o=a.containerWidth,i=a.col,u=a.rowHeight,d=Math.floor(e/o*i),l=Math.floor(t/(u+(n?n[1]:0)));return(0,y.checkInContainer)(d,l,i,r)}},{key:"moveCardInGroupItem",value:function(e,t,r,a){var n=this.props.groups,o=this.props.shadowCard;o=s.default.cloneDeep(o);var i=t.index,u=o.pk_appregister;if(!D.checkCardContainInGroup(n[i],u)){s.default.forEach(n,function(e,t){s.default.remove(e.apps,function(e){return!0===e.isShadow})}),n[i].apps.push(o);var d=this.calGridXY(r,a,o.width),l=d.GridX,p=d.GridY;o.gridx=l,o.gridy=p;var c=(0,m.layoutCheck)(n[i].apps,o,o.pk_appregister,o.pk_appregister),f=(0,v.compactLayout)(c,o);n[i].apps=f,this.props.updateShadowCard(o),this.props.updateGroupList(n)}}},{key:"moveGroupItem",value:function(e,t){var r=this.props.groups,a=(r=s.default.cloneDeep(r))[e];r.splice(e,1),r.splice(t,0,a),this.props.updateGroupList(r)}},{key:"onDrop",value:function(e,t){if(e.type!==t.type){for(var r=this.props.groups,a=void 0,n=void 0,o=void 0,i=void 0,u=0,d=(r=s.default.cloneDeep(r)).length;u<d;u++){r[u].pk_app_group===t.id&&(n=u);for(var l=0,p=r[u].apps.length;l<p;l++){var c=r[u].apps;c[l].pk_appregister===e.id&&(a=c[l],o=l,i=u)}}r[i].apps.splice(o,1),r[n].apps.push(a),this.props.updateGroupList(r)}}},{key:"createGroupItem",value:function(e,t,r,a,n,o){return c.default.createElement(b.default,{key:e,id:e,type:r,index:a,length:n,cards:o,groupname:t,moveCardInGroupItem:this.moveCardInGroupItem.bind(this),onDrop:this.onDrop.bind(this),moveGroupItem:this.moveGroupItem.bind(this)})}},{key:"addFirstGroupItem",value:function(e){var t=this.props.groups;t=s.default.cloneDeep(t);var r={pk_app_group:"newGroupItem"+(new Date).getTime(),groupname:"分组",type:"group",apps:[]};t.push(r),this.props.updateGroupList(t)}},{key:"initGroupItem",value:function(e){var t=this,r=[];return 0===e.length&&r.push(c.default.createElement("div",{className:"first-add"},c.default.createElement(a.default,{className:"group-item-add",onClick:function(){t.addFirstGroupItem()}}," + 添加分组"))),s.default.forEach(e,function(a,n){r.push(t.createGroupItem(a.pk_app_group,a.groupname,a.type,n,e.length,a.apps))}),r}},{key:"saveGroupItemAndCard",value:function(){var e=[];s.default.forEach(this.props.groups,function(t,r){var a={groupname:t.groupname,apps:[],position:r};-1===t.pk_app_group.indexOf("newGroupItem")&&(a.pk_app_group=t.pk_app_group),s.default.forEach(t.apps,function(e){if(-1!==e.pk_appregister.indexOf("_")){var t=e.pk_appregister.split("_");e.pk_appregister=t[0]}a.apps.push({pk_appregister:e.pk_appregister,gridx:e.gridx,gridy:e.gridy})}),e.push(a)});var t={relateid:this.state.relateid,data:e};console.log(t),(0,f.default)({url:"/nccloud/platform/appregister/setapp.do",data:t,success:function(e){var t=e.data;t.data,t.success}})}},{key:"render",value:function(){var e=this.props.groups;return c.default.createElement(l.default,null,c.default.createElement(E,{style:{height:"48px"}}),c.default.createElement("div",{className:"bread-crumb",style:{height:"20px"}},"面包屑"),c.default.createElement(l.default,null,c.default.createElement(k.default,{contentHeight:"calc(100vh - 68px)"}),c.default.createElement(x,{style:{height:"calc(100vh - 116px)"}},c.default.createElement("div",{className:"nc-workbench-home-container"},this.initGroupItem(e)))),c.default.createElement(C.default,{saveGroupItemAndCard:this.saveGroupItemAndCard.bind(this)}))}}]),t}(p.Component),O=(0,g.DragDropContext)(h.default)(S);t.default=(0,w.connect)(function(e){return{groups:e.templateDragData.groups,shadowCard:e.templateDragData.shadowCard,layout:e.templateDragData.layout}},{updateShadowCard:I.updateShadowCard,updateGroupList:I.updateGroupList})(O)},624:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateRelateID=t.updateLayout=t.updateCurrEditID=t.updateSelectCardInGroupObj=t.updateGroupList=t.updateShadowCard=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(264));t.updateShadowCard=function(e){return{type:a.UPDATESHADOWCARD,shadowCard:e}},t.updateGroupList=function(e){return{type:a.UPDATEGROUPLIST,groups:e}},t.updateSelectCardInGroupObj=function(e){return{type:a.UPDATESELECTCARDINGROUPOBJ,selectCardInGroupObj:e}},t.updateCurrEditID=function(e){return{type:a.UPDATECURREDITID,currEditID:e}},t.updateLayout=function(e){return{type:a.UPDATELAYOUT,layout:e}},t.updateRelateID=function(e){return{type:a.UPDATERELATEID,relateid:e}}},638:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setGridXGridYMaxInCards=t.removeCardIDInSelectCardInGroupObj=t.getAddedGroupItemCount=t.checkCardContainInGroup=t.setIsShadowForCards=t.removeCardByGroupIDAndCardID=t.removeCardInGroupByCardID=t.getCardByGroupIDAndCardID=t.getGroupIndexByGroupID=t.getGroupByGroupID=void 0;var a=n(r(622));n(r(713));function n(e){return e&&e.__esModule?e:{default:e}}t.getGroupByGroupID=function(e,t){var r={};return a.default.forEach(e,function(e){if(e.pk_app_group===t)return r=e,!1}),r},t.getGroupIndexByGroupID=function(e,t){var r=void 0;return a.default.forEach(e,function(e,a){if(e.pk_app_group===t)return r=a,!1}),r},t.getCardByGroupIDAndCardID=function(e,t,r){var n={},o={};return a.default.forEach(e,function(e){if(e.pk_app_group===t)return n=e,!1}),a.default.forEach(n.apps,function(e){if(e.pk_appregister===r)return o=e,!1}),o},t.removeCardInGroupByCardID=function(e,t){return a.default.remove(e.apps,function(e){return e.pk_appregister===t})[0]},t.removeCardByGroupIDAndCardID=function(e,t,r){var n=void 0;return a.default.forEach(e,function(e,r){if(e.pk_app_group===t)return n=r,!1}),a.default.remove(e[n].apps,function(e){return e.pk_appregister===r})[0]},t.setIsShadowForCards=function(e,t){a.default.forEach(e,function(e,t){a.default.forEach(e.apps,function(e){e.isShadow=!1})})},t.checkCardContainInGroup=function(e,t){var r=!1;return a.default.forEach(e.apps,function(e){e.pk_appregister===t&&!1===e.isShadow&&(r=!0)}),r},t.getAddedGroupItemCount=function(e){var t=0;return a.default.forEach(e,function(e){-1!==e.pk_app_group.indexOf("newGroupItem")&&t++}),t},t.removeCardIDInSelectCardInGroupObj=function(e,t,r){e[t]&&a.default.remove(e[t],function(e){return e===r})},t.setGridXGridYMaxInCards=function(e){a.default.forEach(e,function(e){e.gridy=9999})}},646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.layoutCheck=t.getFirstCollison=t.collision=void 0;var a,n=r(3),o=(a=n)&&a.__esModule?a:{default:a};var i=t.collision=function(e,t){return e.gridx===t.gridx&&e.gridy===t.gridy&&e.width===t.width&&e.height===t.height||!(e.gridx+e.width<=t.gridx)&&(!(e.gridx>=t.gridx+t.width)&&(!(e.gridy+e.height<=t.gridy)&&!(e.gridy>=t.gridy+t.height)))};t.getFirstCollison=function(e,t){for(var r=0,a=e.length;r<a;r++)if(i(e[r],t))return e[r];return null},t.layoutCheck=function e(t,r,a,n){for(var u=[],d=[],l=t.map(function(e,t){if(e.pk_appregister!==a){if(i(e,r)){u.push(e.pk_appregister);var l=e.gridy+1;r.gridy>e.gridy&&r.gridy<e.gridy+e.height&&(l=e.gridy);var p=(0,o.default)({},e,{gridy:l});return d.push(p),p}}else if(n===a)return(0,o.default)({},e,r);return e}),p=d.length,c=0;c<p;c++)l=e(l,d[c],u[c],n);return l}},655:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compactLayout=void 0;var a,n=r(3),o=(a=n)&&a.__esModule?a:{default:a},i=r(646);var u=function(e,t){var r=(0,o.default)({},t);if(0===e.length)return(0,o.default)({},r,{gridy:0});for(;;){var a=(0,i.getFirstCollison)(e,r);if(a)return r.gridy=a.gridy+a.height,r;if(r.gridy--,r.gridy<0)return(0,o.default)({},r,{gridy:0})}};t.compactLayout=function(e,t){for(var r=function(e){return[].concat(e).sort(function(e,t){return e.gridy>t.gridy||e.gridy===t.gridy&&e.gridx>t.gridx?1:e.gridy===t.gridy&&e.gridx===t.gridx?0:-1})}(e),a=[],n=Array(e.length),o=0,i=r.length;o<i;o++){var d=u(a,r[o]);a.push(d),n[o]=d}return n}},671:function(e,t,r){e.exports=r.p+"img1.png"},713:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(r(182)),n=v(r(625)),o=v(r(85)),i=v(r(6)),u=v(r(15)),d=v(r(4)),l=v(r(7));r(640),r(627);var p=r(1),c=v(p),s=(v(r(0)),r(629)),f=(r(9),r(93)),h=r(624),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(638)),m=v(r(622));function v(e){return e&&e.__esModule?e:{default:e}}var y={beginDrag:function(e,t,r){var a=e.selectCardInGroupObj;a=m.default.cloneDeep(a),g.removeCardIDInSelectCardInGroupObj(a,e.groupID,e.id),e.updateSelectCardInGroupObj(a);var n=g.getCardByGroupIDAndCardID(e.groups,e.groupID,e.id);return n.isShadow=!0,e.updateShadowCard(n),{id:e.id,type:e.type}},endDrag:function(e,t,r){var a=e.groups;a=m.default.cloneDeep(a),g.setIsShadowForCards(a,!1),e.updateGroupList(a),e.updateShadowCard({})},isDragging:function(e,t){}},k={hover:function(e,t,r){},drop:function(e,t,r){if(m.default.isNull(t.getDropResult())){t.getItem().type}}};var C=function(e){function t(e){return(0,i.default)(this,t),(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,u.default)(t,[{key:"shouldComponentUpdate",value:function(e,t){return!(m.default.isEmpty(this.props.shadowCard)&&!m.default.isEmpty(e.shadowCard))}},{key:"componentWillReceiveProps",value:function(e){!this.props.isOver&&e.isOver,this.props.isOver&&e.isOver}},{key:"calGridItemPosition",value:function(e,t){var r=this.props.layout,a=r.margin,n=r.rowHeight,o=r.calWidth;return{x:Math.round(e*o+a[0]*(e+1)),y:Math.round(t*n+a[1]*(t+1))}}},{key:"calWHtoPx",value:function(e,t){var r=this.props.layout,a=r.margin,n=r.calWidth,o=r.rowHeight;return{wPx:Math.round(e*n+(e-1)*a[0]),hPx:Math.round(t*o+(t-1)*a[1])}}},{key:"deleteCard",value:function(e,t){var r=this.props,a=r.groups,n=r.selectCardInGroupObj;a=m.default.cloneDeep(a),n=m.default.cloneDeep(n),g.removeCardByGroupIDAndCardID(a,t,e),g.removeCardIDInSelectCardInGroupObj(n,t,e),this.props.updateGroupList(a),this.props.updateSelectCardInGroupObj(n)}},{key:"onCheckboxChange",value:function(e,t){var r=this.props.groupID,a=e.target.checked,n=this.props.selectCardInGroupObj;n=m.default.cloneDeep(n),a?(n[r]||(n[r]=[]),n[r].push(t)):g.removeCardIDInSelectCardInGroupObj(n,r,t),this.props.updateSelectCardInGroupObj(n),console.log(n)}},{key:"isChecked",value:function(e){var t=this.props.groupID;return-1!==m.default.indexOf(this.props.selectCardInGroupObj[t],e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.connectDragSource,o=t.connectDropTarget,i=(t.isDragging,t.isOver,t.groupID),u=this.props,d=u.id,l=(u.name,u.gridx),p=u.gridy,s=u.width,f=u.height,h=u.isShadow,g=this.calGridItemPosition(l,p),m=g.x,v=g.y,y=this.calWHtoPx(s,f),k=y.wPx,C=y.hPx;return r(o(h?c.default.createElement("div",{className:"card-shadow",style:{width:k,height:C,transform:"translate("+m+"px, "+v+"px)"}}):c.default.createElement("div",{className:"card",style:{width:k,height:C,transform:"translate("+m+"px, "+v+"px)"}},c.default.createElement("div",{style:{"padding-left":"10px"}},d),c.default.createElement("div",null),c.default.createElement("div",{className:"card-footer"},c.default.createElement(n.default,{checked:this.isChecked(d),onChange:function(t){e.onCheckboxChange(t,d)}}),c.default.createElement(a.default,{type:"delete",className:"card-delete",onClick:function(){e.deleteCard(d,i)}})))))}}]),t}(p.Component),b=(0,s.DropTarget)("item",k,function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}})((0,s.DragSource)("item",y,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(C));t.default=(0,f.connect)(function(e){return{groups:e.templateDragData.groups,selectCardInGroupObj:e.templateDragData.selectCardInGroupObj,shadowCard:e.templateDragData.shadowCard,layout:e.templateDragData.layout}},{updateShadowCard:h.updateShadowCard,updateGroupList:h.updateGroupList,updateSelectCardInGroupObj:h.updateSelectCardInGroupObj})(b)},834:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=w(r(22)),n=w(r(623)),o=w(r(182)),i=w(r(626)),u=w(r(3)),d=w(r(85)),l=w(r(6)),p=w(r(15)),c=w(r(4)),s=w(r(7));r(259),r(640),r(260);var f=r(1),h=w(f),g=(w(r(0)),r(9)),m=r(93),v=r(629),y=w(r(713)),k=w(r(622)),C=(r(646),r(655),function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(638))),b=r(624);function w(e){return e&&e.__esModule?e:{default:e}}var I={hover:function(e,t,r){var a=t.getItem();if("group"===a.type){var n=t.getItem().index,o=e.index;if(n===o)return;var i=(0,g.findDOMNode)(r).getBoundingClientRect(),u=(i.bottom-i.top)/2,d=t.getClientOffset().y-i.top;if(n<o&&d<u)return;if(n>o&&d>u)return;e.moveGroupItem(n,o),t.getItem().index=o}else{var l=e,p=t.getClientOffset(),c=p.x,s=p.y,f=(0,g.findDOMNode)(r).getBoundingClientRect(),h=f.x,m=f.y;e.moveCardInGroupItem(a,l,c-h,s-m)}},drop:function(e,t,r){var a=t.getItem(),n=e;"group"===a.type&&e.onDrop(a,n)}};var D=function(e){function t(e){(0,l.default)(this,t);var r=(0,c.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return r.deleteGroupItem=function(e){var t=r.props,a=t.groups,n=t.selectCardInGroupObj;a=k.default.cloneDeep(a),n=k.default.cloneDeep(n),k.default.remove(a,function(t){return t.pk_app_group===e}),n[e]&&(n[e]=[]),r.props.updateSelectCardInGroupObj(n),r.props.updateGroupList(a)},r.getGroupName=function(e){var t=e.target.value;r.setState({groupName:t})},r.state={groupName:e.groupname},r}return(0,s.default)(t,e),(0,p.default)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.shadowCard.pk_appregister&&(!this.props.isOver&&e.isOver,this.props.isOver&&e.isOver)}},{key:"createCards",value:function(e,t){var r=[];return k.default.forEach(e,function(e){r.push(h.default.createElement(y.default,(0,u.default)({dragCardID:-1,type:e.apptype},e,{id:e.pk_appregister,groupID:t,key:e.pk_appregister})))}),r}},{key:"upGroupItem",value:function(e){var t=this.props.groups;t=k.default.cloneDeep(t);var r=C.getGroupIndexByGroupID(t,e);if(0!==r){var a=t[r-1];t[r-1]=t[r],t[r]=a,this.props.updateGroupList(t)}}},{key:"downGroupItem",value:function(e){var t=this.props.groups;t=k.default.cloneDeep(t);var r=C.getGroupIndexByGroupID(t,e);if(r!==t.length-1){var a=t[r+1];t[r+1]=t[r],t[r]=a,this.props.updateGroupList(t)}}},{key:"addGroupItem",value:function(e){var t=this.props.groups;t=k.default.cloneDeep(t);var r=void 0;k.default.forEach(t,function(t,a){if(t.pk_app_group===e)return r=a,!1});var a={pk_app_group:"newGroupItem"+(new Date).getTime(),groupname:"分组("+(C.getAddedGroupItemCount(t)+1)+")",type:"group",apps:[]};t.splice(r+1,0,a),this.props.updateGroupList(t)}},{key:"editGroupItemName",value:function(e){this.props.updateCurrEditID(e)}},{key:"changeGroupName",value:function(e,t){var r=this.props.groups;r=k.default.cloneDeep(r),k.default.forEach(r,function(r,a){if(r.pk_app_group===e)return r.groupname=t,!1}),this.props.updateGroupList(r),this.props.updateCurrEditID("")}},{key:"cancelGroupName",value:function(){this.props.updateCurrEditID("")}},{key:"getContainerMaxHeight",value:function(e){var t=k.default.chain(e).sortBy(["gridx","gridy"]).groupBy("gridx").value(),r=[];k.default.forEach(t,function(e){var t=e[e.length-1];r.push(t.gridy+t.height)});var a=k.default.max(r);return a*this.props.layout.rowHeight+(a-1)*this.props.layout.margin[1]+2*this.props.layout.margin[1]}},{key:"calColWidth",value:function(){var e=this.props.layout,t=e.containerWidth,r=e.col,a=e.containerPadding,n=e.margin;return n?(t-2*a[0]-n[0]*(r+1))/r:(t-2*a[0]-0*(r+1))/r}},{key:"calColCount",value:function(){var e=this.props.defaultLayout.calWidth,t=this.props.layout,r=t.containerWidth,a=t.containerPadding,n=t.margin;if(n)return Math.floor((r-2*a[0]-n[0])/(e+n[0]))}},{key:"componentDidMount",value:function(){var e=this.props.layout;e=k.default.cloneDeep(e);var t=document.querySelector("#card-container").clientWidth,r=window.innerWidth-120;this.props.layout.containerWidth=r;var a=this.calColCount();this.props.layout.col=a,this.props.layout.containerWidth=t;var n=this.calColWidth();e.calWidth=e.rowHeight=n,e.col=a,e.containerWidth=t,console.log(e),this.props.updateLayout(e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.isDragging,a=t.connectDragSource,u=t.connectDropTarget,d=t.isOver,l=t.groupname,p=t.id,c=t.index,s=t.length,f=t.cards,g=t.currEditID,m=t.defaultLayout,v=this.getContainerMaxHeight(f),y=r?0:1,k=void 0;return k=g===p?h.default.createElement("div",{className:"group-item-title-container-no-edit"},h.default.createElement("div",{class:"title-left"},h.default.createElement(i.default,{size:"small",placeholder:"占位符",defaultValue:l,onPressEnter:function(){e.changeGroupName(p,e.state.groupName)},onChange:this.getGroupName.bind(this)}),h.default.createElement(o.default,{type:"check-square-o",className:"group-item-icon",title:"占位符",onClick:function(){e.changeGroupName(p,e.state.groupName)}}),h.default.createElement(o.default,{type:"close-square-o",className:"group-item-icon",title:"占位符",onClick:function(){e.cancelGroupName()}}))):h.default.createElement("div",{className:"group-item-title-container-no-edit"},h.default.createElement("div",{class:"title-left"},h.default.createElement("span",null,l)),h.default.createElement("div",{class:"title-right"},h.default.createElement("div",{className:"group-item-title-edit"},h.default.createElement(o.default,{type:"edit",title:"占位符",className:"group-item-icon",onClick:function(){e.editGroupItemName(p)}})),h.default.createElement("div",{className:0===c?"group-item-title-not-edit":"group-item-title-edit"},h.default.createElement(o.default,{type:"up-square-o",title:"占位符",className:"group-item-icon",onClick:function(){e.upGroupItem(p)}})),h.default.createElement("div",{className:c===s-1?"group-item-title-not-edit":"group-item-title-edit"},h.default.createElement(o.default,{type:"down-square-o",title:"占位符",className:"group-item-icon",onClick:function(){e.downGroupItem(p)}})),h.default.createElement("div",{className:"group-item-title-edit"},h.default.createElement(o.default,{type:"close-square-o",title:"占位符",className:"group-item-icon",onClick:function(){e.deleteGroupItem(p)}})))),a(u(h.default.createElement("div",{className:"group-item",style:{opacity:y}},h.default.createElement("div",{className:"group-item-container",style:{background:d?"rgb(172, 175, 175)":"#ccc"}},k,h.default.createElement("section",{id:"card-container",style:{height:v>m.containerHeight?v:m.containerHeight}},this.createCards(f,p))),h.default.createElement("div",null,h.default.createElement(n.default,{className:"group-item-add",onClick:function(){e.addGroupItem(p)}}," + 添加分组")))))}}]),t}(f.Component),G=(0,v.DropTarget)("item",I,function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}})((0,v.DragSource)("item",{beginDrag:function(e,t,r){return{id:e.id,index:e.index,type:e.type}},canDrag:function(e,t){return""===e.currEditID}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(D));t.default=(0,m.connect)(function(e){var t;return t={groups:e.templateDragData.groups,shadowCard:e.templateDragData.shadowCard,layout:e.templateDragData.layout,defaultLayout:e.templateDragData.defaultLayout},(0,a.default)(t,"defaultLayout",e.templateDragData.defaultLayout),(0,a.default)(t,"currEditID",e.templateDragData.currEditID),(0,a.default)(t,"selectCardInGroupObj",e.templateDragData.selectCardInGroupObj),t},{updateGroupList:b.updateGroupList,updateCurrEditID:b.updateCurrEditID,updateLayout:b.updateLayout,updateSelectCardInGroupObj:b.updateSelectCardInGroupObj})(G)},835:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=k(r(643)),n=k(r(623)),o=k(r(85)),i=k(r(6)),u=k(r(15)),d=k(r(4)),l=k(r(7)),p=k(r(632));r(645),r(259),r(639);var c=r(1),s=k(c),f=k(r(622)),h=(k(r(258)),r(646)),g=r(655),m=r(93),v=r(624),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(638));function k(e){return e&&e.__esModule?e:{default:e}}var C=p.default.Group,b=function(e){function t(e){(0,i.default)(this,t);var r=(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return r.getMoveCardButton=function(e,t){var a=r.checkInSelectCardInGroupObj();return s.default.createElement(n.default,{disabled:a,onClick:function(){t(!0)}},e)},r.state={modalVisible:!1,selectedValue:0},r}return(0,l.default)(t,e),(0,u.default)(t,[{key:"deleteSelectedCardArr",value:function(){var e=this.props,t=e.groups,r=e.selectCardInGroupObj;t=f.default.cloneDeep(t),r=f.default.cloneDeep(r),f.default.forEach(r,function(e,r){f.default.forEach(e,function(e){y.removeCardByGroupIDAndCardID(t,r,e)})}),this.props.updateGroupList(t),this.props.updateSelectCardInGroupObj({})}},{key:"getGroupItemNameRadio",value:function(e){if(e)return s.default.createElement(C,{className:"modal-radio-group",value:this.state.selectedValue,onChange:this.onChangeRadio.bind(this)},e.map(function(e,t){return s.default.createElement(p.default,{className:"modal-radio",key:e.pk_app_group,value:e.pk_app_group},e.groupname)}))}},{key:"setModalVisible",value:function(e){this.setState({modalVisible:e,selectedValue:0})}},{key:"onChangeRadio",value:function(e){this.setState({selectedValue:e.target.value})}},{key:"onOkMoveDialog",value:function(e){var t=this.state.selectedValue;if(0!==t){var r=this.props,a=r.groups,n=r.selectCardInGroupObj;n=f.default.cloneDeep(n),a=f.default.cloneDeep(a);var o=f.default.keys(n);-1===o.indexOf(t)&&o.push(t);var i=[],u=-1;f.default.forEach(a,function(e,r){if(e.pk_app_group!==t){var a=f.default.remove(e.apps,function(t){return-1!==f.default.indexOf(n[e.pk_app_group],t.pk_appregister)});i=f.default.concat(i,a)}else u=r}),y.setGridXGridYMaxInCards(i),a[u].apps=f.default.concat(a[u].apps,i),a[u].apps=f.default.uniqBy(a[u].apps,"pk_appregister"),f.default.forEach(a,function(e){if(-1!==o.indexOf(e.pk_app_group)&&0!==e.apps.length){var t=e.apps[0],r=(0,h.layoutCheck)(e.apps,t,t.pk_appregister,t.pk_appregister),a=(0,g.compactLayout)(r);e.apps=a}}),this.props.updateSelectCardInGroupObj({}),this.props.updateGroupList(a),this.setModalVisible(e)}}},{key:"saveGroupItemAndCard",value:function(){this.props.saveGroupItemAndCard()}},{key:"cancleSave",value:function(){location.reload()}},{key:"checkInSelectCardInGroupObj",value:function(){var e=this.props.selectCardInGroupObj,t=!0;return f.default.forEach(e,function(e){if(e.length>0)return t=!1,!1}),t}},{key:"render",value:function(){var e=this,t=this.props.groups,r=this.getGroupItemNameRadio(t);return s.default.createElement("div",{className:"nc-workbench-home-footer"},s.default.createElement("div",{className:"footer-left"},this.getMoveCardButton("删除",this.deleteSelectedCardArr.bind(this)),this.getMoveCardButton("移动",this.setModalVisible.bind(this))),s.default.createElement("div",{className:"footer-right"},s.default.createElement(n.default,{className:"right-button",type:"primary",onClick:this.saveGroupItemAndCard.bind(this)},"保存"),s.default.createElement(n.default,{className:"right-button",onClick:this.cancleSave.bind(this)},"取消")),s.default.createElement(a.default,{title:"移动到",mask:!1,wrapClassName:"vertical-center-modal",visible:this.state.modalVisible,onOk:function(){return e.onOkMoveDialog(!1)},onCancel:function(){return e.setModalVisible(!1)},footer:[s.default.createElement(n.default,{key:"submit",disabled:0===this.state.selectedValue,type:"primary",onClick:function(){return e.onOkMoveDialog(!1)}},"确定"),s.default.createElement(n.default,{key:"back",onClick:function(){return e.setModalVisible(!1)}},"取消")]},r))}}]),t}(c.Component);t.default=(0,m.connect)(function(e){return{groups:e.templateDragData.groups,shadowCard:e.templateDragData.shadowCard,selectCardInGroupObj:e.templateDragData.selectCardInGroupObj,layout:e.templateDragData.layout}},{updateSelectCardInGroupObj:v.updateSelectCardInGroupObj,updateGroupList:v.updateGroupList})(b)},836:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(r(625)),n=v(r(85)),o=v(r(6)),i=v(r(15)),u=v(r(4)),d=v(r(7)),l=v(r(3));r(627);var p=r(1),c=v(p),s=(v(r(0)),r(629)),f=(r(9),v(r(671))),h=r(93),g=r(624),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(638));function v(e){return e&&e.__esModule?e:{default:e}}var y={beginDrag:function(e,t,r){console.log(e);var a={pk_appregister:e.id,width:e.width,height:e.height,name:e.id};return e.updateShadowCard((0,l.default)({},a,{isShadow:!0})),{id:a.pk_appregister}},endDrag:function(e,t,r){var a=e.groups;m.setIsShadowForCards(a,!1),e.updateShadowCard({})}};var k=function(e){function t(e){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,d.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=this.props.connectDragSource,r=this.props,n=(r.id,r.index),o=r.name,i=r.checked,u=r.parentIndex;return t(c.default.createElement("div",{className:"list-item-content"},c.default.createElement("div",{className:"title"},c.default.createElement("span",null,o),c.default.createElement(a.default,{checked:i,onChange:function(t){e.props.onChangeChecked(t,u,n)}})),c.default.createElement("div",{className:"img",style:{background:"url("+f.default+") no-repeat 0px 0px","background-size":"contain"}})))}}]),t}(p.Component),C=(0,s.DragSource)("item",y,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(k);t.default=(0,h.connect)(function(e){return{groups:e.templateDragData.groups}},{updateShadowCard:g.updateShadowCard})(C)},856:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(r(643)),n=E(r(623)),o=E(r(717)),i=E(r(625)),u=E(r(695)),d=E(r(626)),l=E(r(182)),p=E(r(85)),c=E(r(6)),s=E(r(15)),f=E(r(4)),h=E(r(7)),g=E(r(632)),m=E(r(635));r(645),r(259),r(715),r(627),r(714),r(260),r(640),r(639),r(642);var v=r(1),y=E(v),k=E(r(622)),C=E(r(836)),b=r(93),w=r(646),I=r(655),D=r(624),G=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(638)),_=E(r(258));function E(e){return e&&e.__esModule?e:{default:e}}var x=m.default.Sider,S=g.default.Group,O=function(e){function t(e){(0,c.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,p.default)(t)).call(this,e));return r.onCheckAllChange=function(e,t){var a=e.target.checked,n=r.state.appGroupArr,o=n[t];o.checkedAll=e.target.checked,o.indeterminate=!1,k.default.forEach(o.children,function(e){e.checked=a}),r.setState({appGroupArr:n})},r.onChangeChecked=function(e,t,a){var n=e.target.checked,o=r.state.appGroupArr,i=o[t];i.children[a].checked=n;var u=0;k.default.forEach(i.children,function(e){e.checked&&u++}),i.checkedAll=u===i.children.length,i.indeterminate=!!u&&u<i.children.length,console.log(i.indeterminate),r.setState({appGroupArr:o})},r.state={showSearch:!1,searchValue:"",appGroupArr:[],modalVisible:!1,selectedValue:0,isShowAll:!0},r}return(0,h.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=this;(0,_.default)({url:"/nccloud/platform/appregister/queryapplazy.do",success:function(t){if(t){var r=t.data,a=r.data,n=r.success;n&&a&&a.length>0&&e.setState({domainArr:a})}}})}},{key:"onInputChange",value:function(e){var t=e.target.value;this.state.searchValue=t}},{key:"onInputSearch",value:function(){(0,_.default)({url:"/nccloud/platform/appregister/queryapplazy.do",data:{search_content:this.state.searchValue,userid:"1111Z510000000039689"},success:function(e){var t=e.data,r=t.data,a=t.success;a&&r&&r.length>0&&console.log(r)}}),console.log(this.state.searchValue,"搜索开始")}},{key:"onCascaderChange",value:function(e){var t=this,r=e;if(1!==r.length){var a=r[1];(0,_.default)({url:"/nccloud/platform/appregister/queryapplazy.do",data:{own_module:a},success:function(e){var r=e.data,a=r.data,n=r.success;n&&a&&a.length>0&&(console.log(a),k.default.forEach(a,function(e){e.isShow=!0,e.checkedAll=!1,e.indeterminate=!1,k.default.forEach(e.children,function(e){e.checked=!1})}),t.setState({appGroupArr:a,isAllShow:!0}))}}),console.log(e,"选择",this.state)}}},{key:"switchSearch",value:function(){var e=this.state.showSearch;this.setState({showSearch:!e})}},{key:"getSearchDom",value:function(){var e=this;return this.state.showSearch?y.default.createElement("div",{className:"sider-search"},y.default.createElement(d.default,{placeholder:"请输入应用名称",style:{width:"213px"},onPressEnter:this.onInputSearch.bind(this),onChange:this.onInputChange.bind(this),addonAfter:y.default.createElement(l.default,{type:"search",className:"search-input-icon",onClick:this.onInputSearch.bind(this)})}),y.default.createElement("span",{className:"switch-search-cancel",onClick:this.switchSearch.bind(this)},"取消")):y.default.createElement("div",{className:"sider-search"},y.default.createElement(u.default,{className:"search-cascader",style:{width:"213px"},options:this.state.domainArr,onChange:function(t){e.onCascaderChange(t)},placeholder:"领域-模块"}),y.default.createElement("span",{className:"switch-search",onClick:this.switchSearch.bind(this)},y.default.createElement(l.default,{type:"search"})))}},{key:"getResultDom",value:function(){var e=this;return this.state.appGroupArr.map(function(t,r){return y.default.createElement("div",{className:"result-group-list"},y.default.createElement("h4",{className:"result-header"},y.default.createElement(i.default,{checked:t.checkedAll,indeterminate:t.indeterminate,onChange:function(t){e.onCheckAllChange(t,r)}}),y.default.createElement("span",{className:"result-header-name",onClick:function(){e.onChangeShowHide(r)}},t.label,t.isShow?y.default.createElement(l.default,{type:"down"}):y.default.createElement(l.default,{type:"right"}))),y.default.createElement("div",{className:"result-app-list",style:{display:t.isShow?"flex":"none"}},t.children.map(function(t,a){return y.default.createElement("div",{className:"app-col"},y.default.createElement("div",{className:"list-item"},y.default.createElement(C.default,{id:t.value,key:t.value,width:t.width,height:t.height,index:a,parentIndex:r,name:t.label,type:"new",checked:t.checked,onChangeChecked:e.onChangeChecked})))})))})}},{key:"getGroupItemNameRadio",value:function(e){if(e)return y.default.createElement(S,{className:"modal-radio-group",value:this.state.selectedValue,onChange:this.onChangeRadio.bind(this)},e.map(function(e,t){return y.default.createElement(g.default,{className:"modal-radio",key:e.pk_app_group,value:e.pk_app_group},e.groupname)}))}},{key:"setModalVisible",value:function(e){this.setState({modalVisible:e,selectedValue:0})}},{key:"onChangeRadio",value:function(e){this.setState({selectedValue:e.target.value})}},{key:"onOkMoveDialog",value:function(e){var t=this.state.selectedValue,r=this.state.appGroupArr,a=this.props.groups;a=k.default.cloneDeep(a);var n=G.getGroupIndexByGroupID(a,t),o=[];if(0!==t){k.default.forEach(r,function(e){k.default.forEach(e.children,function(t){t.checked&&(o.push({pk_appregister:t.value,width:t.width,height:t.height,name:t.value,isShadow:!1,gridx:0,gridy:9999}),e.checked=!1)})}),a[n].apps=k.default.concat(a[n].apps,o),a[n].apps=k.default.uniqBy(a[n].apps,"pk_appregister");var i=a[n].apps[0],u=(0,w.layoutCheck)(a[n].apps,i,i.pk_appregister,i.pk_appregister),d=(0,I.compactLayout)(u);a[n].apps=d,this.props.updateGroupList(a),this.setModalVisible(e),this.setState({appGroupArr:r})}}},{key:"allShowOrHide",value:function(e){var t=this.state,r=t.appGroupArr;t.isAllShow;k.default.forEach(r,function(t){t.isShow=e}),this.setState({appGroupArr:r,isAllShow:e})}},{key:"onChangeShowHide",value:function(e){var t=this.state.appGroupArr;t[e].isShow=!t[e].isShow,this.setState({appGroupArr:t})}},{key:"hasChechedItem",value:function(){var e=!1,t=this.state.appGroupArr;return k.default.forEach(t,function(t){if(k.default.forEach(t.children,function(t){if(t.checked)return e=!0,!1}),e)return!1}),e}},{key:"render",value:function(){var e=this,t=this.props.contentHeight,r=this.props.groups,i=this.getGroupItemNameRadio(r);return y.default.createElement(x,{className:"nc-workbench-home-sider",breakpoint:"lg",collapsedWidth:"200",width:"300",style:{height:t}},y.default.createElement("div",{className:"sider-content"},this.getSearchDom(),y.default.createElement("div",{className:"add-item"},y.default.createElement(o.default,{checkedChildren:"展开",checked:this.state.isAllShow,unCheckedChildren:"收缩",className:0===this.state.appGroupArr.length?"cannot-add":"aaa",onChange:this.allShowOrHide.bind(this)}),",",y.default.createElement(l.default,{className:this.hasChechedItem()?"add":"cannot-add",type:"plus-circle-o",title:"占位符",onClick:function(){e.setModalVisible(!0)}})),y.default.createElement("div",{className:"sider-result"},this.getResultDom())),y.default.createElement(a.default,{title:"添加到",mask:!1,wrapClassName:"vertical-center-modal",visible:this.state.modalVisible,onOk:function(){return e.onOkMoveDialog(!1)},onCancel:function(){return e.setModalVisible(!1)},footer:[y.default.createElement(n.default,{key:"submit",disabled:0===this.state.selectedValue,type:"primary",onClick:function(){return e.onOkMoveDialog(!1)}},"确定"),y.default.createElement(n.default,{key:"back",onClick:function(){return e.setModalVisible(!1)}},"取消")]},i))}}]),t}(v.Component);t.default=(0,b.connect)(function(e){return{groups:e.templateDragData.groups}},{updateGroupList:D.updateGroupList})(O)},857:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkInContainer=function(e,t,r,a){return e+a>r-1&&(e=r-a),e<0&&(e=0),t<0&&(t=0),{GridX:e,GridY:t}}},920:function(e,t,r){(e.exports=r(45)(!1)).push([e.i,".nc-workbench-home-sider{background:#fff;overflow:auto}.nc-workbench-home-sider .sider-content{margin:10px 5px 15px;padding:10px 8px 0;border:1px solid #ccc}.nc-workbench-home-sider .sider-content .sider-search{display:flex;align-items:center;justify-content:space-between}.nc-workbench-home-sider .sider-content .sider-search .search-input-icon{cursor:pointer}.nc-workbench-home-sider .sider-content .sider-search .switch-search{padding:0 11px;margin-right:0;font-size:20px;cursor:pointer}.nc-workbench-home-sider .sider-content .sider-search .switch-search-cancel{cursor:pointer}.nc-workbench-home-sider .sider-content .add-item{padding:5px;margin:10px 0;display:flex;justify-content:space-between;border-top:1px solid #ccc;border-bottom:1px solid #ccc;align-items:center}.nc-workbench-home-sider .sider-content .add-item .add{cursor:pointer;font-size:19px}.nc-workbench-home-sider .sider-content .add-item .cannot-add{visibility:hidden}.nc-workbench-home-sider .sider-content .sider-result .result-group-list{border-bottom:1px solid #e9e9e9}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-header{padding-left:5px;background:#f4f5f7}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-header .result-header-name{cursor:pointer}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-app-list{width:100%;display:flex;flex-wrap:wrap}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-app-list .app-col{width:50%}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-app-list .app-col .list-item{padding-left:5px;margin-bottom:8px}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-app-list .app-col .list-item .list-item-content{padding:3px 4px;border:1px solid #ccc}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-app-list .app-col .list-item .list-item-content .title{display:flex;justify-content:space-between}.nc-workbench-home-sider .sider-content .sider-result .result-group-list .result-app-list .app-col .list-item .list-item-content .img{height:120px;background-size:contain;border-top:1px solid #ccc}.nc-workbench-home-container{padding:50px 23px 48px}.nc-workbench-home-container .group-item-add{width:100%;border:1px solid rgba(78,89,104,.25)}.nc-workbench-home-container .group-item{width:100%;margin-bottom:10px;cursor:move;position:relative}.nc-workbench-home-container .group-item .group-item-container{padding:10px 0 0 20px}.nc-workbench-home-container .group-item .group-item-container .group-item-icon{font-size:20px}.nc-workbench-home-container .group-item .group-item-container .group-item-title-container-no-edit{display:flex;justify-content:space-between}.nc-workbench-home-container .group-item .group-item-container .group-item-title-container-no-edit i{cursor:pointer}.nc-workbench-home-container .group-item .group-item-container .group-item-title-container-no-edit .title-left{display:flex;align-items:center}.nc-workbench-home-container .group-item .group-item-container .group-item-title-container-no-edit .title-left i{margin-left:7px}.nc-workbench-home-container .group-item .group-item-container .group-item-title-container-no-edit .title-right{display:flex}.nc-workbench-home-container .group-item .group-item-container .group-item-title-container-no-edit .title-right .group-item-title-edit{margin-right:23px}.nc-workbench-home-container .group-item .group-item-container .group-item-title-container-no-edit .title-right .group-item-title-not-edit{color:#e6e9e9;margin-right:23px}.nc-workbench-home-container .group-item .group-item-container #card-container .card-shadow{background:hsla(0,0%,6%,.3);position:absolute;border-radius:3px;transition:all .2s ease-out}.nc-workbench-home-container .group-item .group-item-container #card-container .card{background:#fff;position:absolute;border:1px solid #f1f1f1;border-radius:3px;transition:all .2s ease-out}.nc-workbench-home-container .group-item .group-item-container #card-container .card .card-footer{display:flex;justify-content:space-between;position:absolute;height:35px;width:100%;padding:7px 8px;bottom:0;background:#f2f2f2}.nc-workbench-home-container .group-item .group-item-container #card-container .card .card-footer .card-delete{font-size:19px;line-height:21px;cursor:pointer}.nc-workbench-home-footer{width:calc(100vw - 300px);height:48px;position:fixed;left:300px;bottom:0;border-top:1px solid #ccc;display:flex;justify-content:space-between;align-items:center}.nc-workbench-home-footer button{width:78px;margin:0 8px}.nc-workbench-home-footer .footer-left{display:flex;margin-left:100px}.nc-workbench-home-footer .footer-right{display:flex;margin-right:100px}.vertical-center-modal{display:flex;align-items:center;justify-content:center}.vertical-center-modal .ant-modal{top:0}.modal-radio{display:block!important;height:30px!important;line-height:30px!important}",""])},921:function(e,t,r){var a=r(920);"string"==typeof a&&(a=[[e.i,a,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(49)(a,n);a.locals&&(e.exports=a.locals)}}]);